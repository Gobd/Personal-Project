angular.module("app",["ngResource","ngMessages","ngAnimate","ui.router","satellizer","toastr"]).config(["$authProvider","$stateProvider","$urlRouterProvider","$locationProvider",function(e,r,t,l){function o(e,r){var t=e.defer();return r.isAuthenticated()?t.reject():t.resolve(),t.promise}function a(e,r,t){var l=e.defer();return t.isAuthenticated()?l.resolve():r.path("/login"),l.promise}o.$inject=["$q","$auth"],a.$inject=["$q","$location","$auth"],e.facebook({clientId:"1670205403245071"}),e.google({clientId:"696255640250-ha91c7enlsravhptab5c63punfunlh8u.apps.googleusercontent.com"}),t.otherwise("/home"),r.state("home",{url:"/home:name?/:beer?/:near?",controller:"homeCtrl",templateUrl:"partials/home.html"}).state("login",{url:"/login",templateUrl:"partials/login.html",controller:"loginCtrl",resolve:{skipIfLoggedIn:o}}).state("signup",{url:"/signup",templateUrl:"partials/signup.html",controller:"signupCtrl",resolve:{skipIfLoggedIn:o}}).state("logout",{url:"/logout",template:null,controller:"logoutCtrl"}).state("profile",{url:"/profile",templateUrl:"partials/profile.html",controller:"profileCtrl",resolve:{loginRequired:a}}).state("addBrewery",{url:"/addBrewery",controller:"addBrewery",templateUrl:"partials/addBrewery.html"})}]);
angular.module("app").controller("addBrewery",["$scope","locationService",function(e,d){e.addBrewery=function(r){r.loc={},r.loc.coordinates="",d.searchByAddress(r.address).then(function(o){r.loc.coordinates=[o.data[0].longitude,o.data[0].latitude],d.addBrewery(r).then(function(d){e.addedBrewery=d,e.brewery={}})})}}]);
angular.module("app").controller("homeCtrl",["$scope","locationService",function(o,e){o.breweryDetails=function(o){console.log(o)}}]);
angular.module("app").service("locationService",["$http","$q","$location",function(t,r,e){function o(){var t=r.defer();return navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(r){t.resolve(r)},function(r){t.reject(r)}),t.promise}this.getAddressFromCoords=function(){return o().then(function(r){return t({method:"GET",params:{lat:r.coords.latitude,"long":r.coords.longitude},url:"http://localhost:3001/getAddress"})})},this.searchByAddress=function(r){return t({method:"GET",params:{address:r},url:"http://localhost:3001/getCoords"})},this.addBrewery=function(r){return t({method:"POST",data:r,url:"http://localhost:3001/addBrewery"})},this.getBrewery=function(r){if(r){var o="?";for(var n in r)r.hasOwnProperty(n)&&(o+=n+"="+r[n]+"&");return e.url(o.slice(0,o.length-1)),t({method:"GET",params:r,url:"http://localhost:3001/getBrewery"})}return t({method:"GET",params:r,url:"http://localhost:3001/getBrewery"})}}]);
angular.module("app").directive("navDir",function(){return{restrict:"AE",replace:"true",scope:{brewery:"=",search:"="},templateUrl:"./partials/Directives/navDir.html",controller:["$scope","$auth","locationService",function(e,r,t){e.isAuthenticated=function(){return r.isAuthenticated()},e.goHome=function(){t.getBrewery().then(function(r){e.brewery=r.data,e.search.name="",e.search.beer=""})}}]}});
angular.module("app").directive("searchDir",function(){return{restrict:"AE",replace:"true",templateUrl:"./partials/Directives/searchDir.html",controller:"searchDirCtrl",scope:{brewery:"=",search:"="}}});
angular.module("app").controller("searchDirCtrl",["$scope","locationService","$location",function(e,t,r){function a(){t.getAddressFromCoords().then(function(t){e.coords={lat:t.data[0].latitude,lon:t.data[0].longitude},e.search={},e.search.location=t.data[0].formattedAddress,e.getBrewery(e.search)})}function n(e){return 0===Object.keys(e).length}n(r.search())?a():t.getBrewery(r.search()).then(function(t){e.search=r.search(),e.brewery=t.data}),e.getBrewery=function(r){t.getBrewery(r).then(function(t){e.brewery=t.data})},e.searchByAddress=function(r){t.searchByAddress(r).then(function(t){e.coords={lat:t.data[0].latitude,lon:t.data[0].longitude}})},e.details=function(e){console.log(e)}}]);
angular.module("app").factory("Account",["$http",function(t){return{getProfile:function(){return t.get("http://localhost:3001/api/me")},updateProfile:function(o){return t.put("http://localhost:3001/api/me",o)}}}]);
angular.module("app").controller("loginCtrl",["$scope","$location","$auth","toastr",function(t,e,n,a){t.login=function(){n.login(t.user).then(function(){a.success("You have successfully signed in!"),e.path("/")})["catch"](function(t){a.error(t.data.message,t.status)})},t.authenticate=function(t){n.authenticate(t).then(function(){a.success("You have successfully signed in with "+t+"!"),e.path("/")})["catch"](function(t){t.error?a.error(t.error):t.data?a.error(t.data.message,t.status):a.error(t)})}}]);
angular.module("app").controller("logoutCtrl",["$location","$auth","toastr",function(o,t,n){t.isAuthenticated()&&t.logout().then(function(){n.info("You have been logged out"),o.path("/")})}]);
angular.module("app").directive("passwordMatch",function(){return{require:"ngModel",scope:{otherModelValue:"=passwordMatch"},link:function(e,o,a,r){r.$validators.compareTo=function(o){return o===e.otherModelValue},e.$watch("otherModelValue",function(){r.$validate()})}}});
angular.module("app").controller("profileCtrl",["$scope","$auth","toastr","Account",function(t,n,e,a){t.getProfile=function(){a.getProfile().then(function(n){t.user=n.data})["catch"](function(t){e.error(t.data.message,t.status)})},t.updateProfile=function(){a.updateProfile(t.user).then(function(){e.success("Profile has been updated")})["catch"](function(t){e.error(t.data.message,t.status)})},t.link=function(a){n.link(a).then(function(){e.success("You have successfully linked a "+a+" account"),t.getProfile()})["catch"](function(t){e.error(t.data.message,t.status)})},t.unlink=function(a){n.unlink(a).then(function(){e.info("You have unlinked a "+a+" account"),t.getProfile()})["catch"](function(t){e.error(t.data?t.data.message:"Could not unlink "+a+" account",t.status)})},t.getProfile()}]);
angular.module("app").controller("signupCtrl",["$scope","$location","$auth","toastr",function(n,e,a,t){n.signup=function(){a.signup(n.user).then(function(n){a.setToken(n),e.path("/"),t.info("You have successfully created a new account and have been signed-in")})["catch"](function(n){t.error(n.data.message)})}}]);
//# sourceMappingURL=maps/js.min.js.map
