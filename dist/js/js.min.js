angular.module("app",["ngResource","ngMessages","ngAnimate","ui.router","satellizer","toastr"]).config(["$authProvider","$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,r,l){function o(e,t){var r=e.defer();return t.isAuthenticated()?r.reject():r.resolve(),r.promise}function a(e,t,r){var l=e.defer();return r.isAuthenticated()?l.resolve():t.path("/login"),l.promise}o.$inject=["$q","$auth"],a.$inject=["$q","$location","$auth"],e.facebook({clientId:"1670205403245071"}),e.google({clientId:"696255640250-ha91c7enlsravhptab5c63punfunlh8u.apps.googleusercontent.com"}),r.otherwise("/home"),t.state("home",{url:"/",controller:"homeCtrl",templateUrl:"partials/home.html"}).state("login",{url:"/login",templateUrl:"partials/login.html",controller:"loginCtrl",resolve:{skipIfLoggedIn:o}}).state("signup",{url:"/signup",templateUrl:"partials/signup.html",controller:"signupCtrl",resolve:{skipIfLoggedIn:o}}).state("logout",{url:"/logout",template:null,controller:"logoutCtrl"}).state("profile",{url:"/profile",templateUrl:"partials/profile.html",controller:"profileCtrl",resolve:{loginRequired:a}}).state("addBrewery",{url:"/addBrewery",controller:"addBrewery",templateUrl:"partials/addBrewery.html"})}]);
angular.module("app").controller("addBrewery",["$scope","locationService",function(e,d){e.addBrewery=function(r){r.loc={},r.loc.coordinates="",d.searchByAddress(r.address).then(function(o){r.loc.coordinates=[o.data[0].longitude,o.data[0].latitude],d.addBrewery(r).then(function(d){e.addedBrewery=d,e.brewery={}})})}}]);
angular.module("app").controller("homeCtrl",["$scope","locationService",function(o,e){}]);
angular.module("app").service("locationService",["$http","$q",function(t,r){function e(){var t=r.defer();return navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(r){t.resolve(r)},function(r){t.reject(r)}),t.promise}this.getAddressFromCoords=function(){var r=e().then(function(r){return t({method:"GET",params:{lat:r.coords.latitude,"long":r.coords.longitude},url:"http://localhost:3001/getAddress"})});return r},this.searchByAddress=function(r){return t({method:"GET",params:{address:r},url:"http://localhost:3001/getCoords"})},this.addBrewery=function(r){return t({method:"POST",data:r,url:"http://localhost:3001/addBrewery"})},this.getBrewery=function(r){return t({method:"GET",params:r,url:"http://localhost:3001/getBrewery"})}}]);
angular.module("app").factory("Account",["$http",function(t){return{getProfile:function(){return t.get("http://localhost:3001/api/me")},updateProfile:function(o){return t.put("http://localhost:3001/api/me",o)}}}]);
angular.module("app").controller("loginCtrl",["$scope","$location","$auth","toastr",function(t,e,n,a){t.login=function(){n.login(t.user).then(function(){a.success("You have successfully signed in!"),e.path("/")})["catch"](function(t){a.error(t.data.message,t.status)})},t.authenticate=function(t){n.authenticate(t).then(function(){a.success("You have successfully signed in with "+t+"!"),e.path("/")})["catch"](function(t){t.error?a.error(t.error):t.data?a.error(t.data.message,t.status):a.error(t)})}}]);
angular.module("app").controller("logoutCtrl",["$location","$auth","toastr",function(o,t,n){t.isAuthenticated()&&t.logout().then(function(){n.info("You have been logged out"),o.path("/")})}]);
angular.module("app").directive("passwordMatch",function(){return{require:"ngModel",scope:{otherModelValue:"=passwordMatch"},link:function(e,o,a,r){r.$validators.compareTo=function(o){return o===e.otherModelValue},e.$watch("otherModelValue",function(){r.$validate()})}}});
angular.module("app").controller("profileCtrl",["$scope","$auth","toastr","Account",function(t,n,e,a){t.getProfile=function(){a.getProfile().then(function(n){t.user=n.data})["catch"](function(t){e.error(t.data.message,t.status)})},t.updateProfile=function(){a.updateProfile(t.user).then(function(){e.success("Profile has been updated")})["catch"](function(t){e.error(t.data.message,t.status)})},t.link=function(a){n.link(a).then(function(){e.success("You have successfully linked a "+a+" account"),t.getProfile()})["catch"](function(t){e.error(t.data.message,t.status)})},t.unlink=function(a){n.unlink(a).then(function(){e.info("You have unlinked a "+a+" account"),t.getProfile()})["catch"](function(t){e.error(t.data?t.data.message:"Could not unlink "+a+" account",t.status)})},t.getProfile()}]);
angular.module("app").controller("signupCtrl",["$scope","$location","$auth","toastr",function(n,e,a,t){n.signup=function(){a.signup(n.user).then(function(n){a.setToken(n),e.path("/"),t.info("You have successfully created a new account and have been signed-in")})["catch"](function(n){t.error(n.data.message)})}}]);
angular.module("app").directive("navDir",function(){return{restrict:"AE",replace:"true",templateUrl:"./partials/navDir.html",controller:"NavbarCtrl",scope:{brewery:"="}}});
angular.module("app").controller("NavbarCtrl",["$scope","$auth","locationService",function(t,e,n){t.isAuthenticated=function(){return e.isAuthenticated()},t.getBrewery=function(e){n.getBrewery(e).then(function(e){t.results=e.data})},t.searchByAddress=function(e){n.searchByAddress(e).then(function(e){t.coords={lat:e.data[0].latitude,lon:e.data[0].longitude}})},t.details=function(t){console.log(t)},t.results||n.getBrewery().then(function(e){t.brewery=e.data})}]);
//# sourceMappingURL=maps/js.min.js.map
